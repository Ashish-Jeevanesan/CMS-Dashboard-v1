<div class="filter-container">
  <input [(ngModel)]="city" placeholder="Enter City" />
  <input [(ngModel)]="state" placeholder="Enter State" />
  <button (click)="fetchChurches()">Load Churches</button>
</div>

<div class="church-list-container">
  <h2 class="title">Churches</h2>
  <div *ngIf="loading" class="loading">Loading...</div>
  <table class="church-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>City</th>
        <th>State</th>
        <th>Country</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let church of churches">
        <td>{{ church.name }}</td>
        <td>{{ church.city }}</td>
        <td>{{ church.state }}</td>
        <td>{{ church.country }}</td>
        <td>
          <span [ngClass]="church.status === 'Approved' ? 'approved' : 'pending'">
            {{ church.status === 'Approved' ? 'Approved' : 'Pending Approval' }}
          </span>
        </td>
        <td>
          <div *ngIf="canManageChurches(); else noPermission">
            <button
              *ngIf="church.status !== 'Approved'"
              (click)="approveChurch(church.id, 'Approved')"
              class="approve-btn"
              [disabled]="loading">
              {{ loading ? 'Processing...' : 'Approve' }}
            </button>
            <button
              *ngIf="church.status === 'Approved'"
              (click)="approveChurch(church.id, 'Pending Approval')"
              class="rollback-btn"
              [disabled]="loading">
              {{ loading ? 'Processing...' : 'Rollback' }}
            </button>
          </div>
          <ng-template #noPermission>
            <span class="no-permission">Admin Only</span>
          </ng-template>
        </td>
      </tr>
    </tbody>
  </table>
</div>
